{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}plog_72
       {txt}log:  {res}/Users/macbookair/Desktop/OCP_NEER/Codes/neer_year.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res} 3 Dec 2020, 14:32:48
{txt}
{com}. *--------------------------------Start of do file------------------------------- 
. 
. project, doinfo 
{txt}project master > Project Name: {res}master
{txt}project master > Project Dir.: {res}/Users/macbookair/Desktop/OCP_NEER
{txt}project master > Build start : {res}03dec2020, 14:31:17{txt}
project master > Do-file Name: {res}neer_year.do
{txt}project master > Enclosing do-files:
project master >     {res}master.do
{txt}
{com}. local pdir "`r(pdir)'"
{txt}
{com}. local dofile "`(dofile)'"
{txt}
{com}. 
. project, uses("`pdir'/data_derived/neer/weights_agg1.dta")
{txt}project master > do-file uses: {res}"data_derived/neer/weights_agg1.dta" filesig(107992850:287792){txt}

{com}. project, uses("`pdir'/data_derived/neer/weights_agg2.dta")
{txt}project master > do-file uses: {res}"data_derived/neer/weights_agg2.dta" filesig(2880480489:130824){txt}

{com}. project, uses("`pdir'/data_derived/neer/weights.dta")
{txt}project master > do-file uses: {res}"data_derived/neer/weights.dta" filesig(658233709:417152){txt}

{com}. 
. cd "`pdir'/data_derived/neer/year"
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer/year
{txt}
{com}. *** Merge with weights Year 
. project, uses("`pdir'/data_derived/neer/year/exchange_year.dta")
{txt}project master > do-file uses: {res}"data_derived/neer/year/exchange_year.dta" filesig(512107591:182196){txt}

{com}. use exchange_year , clear 
{txt}
{com}. cd "`pdir'/data_derived/neer"
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer
{txt}
{com}. local myfiles : dir . files "weights*.dta"
{txt}
{com}. foreach file of local myfiles {c -(} 
{txt}  2{com}.         merge 1:m partner year using  `file', gen(_merge_rate)
{txt}  3{com}.         keep if _merge_rate == 3
{txt}  4{com}.         drop _merge_rate 
{txt}  5{com}.         drop if double_weights == .
{txt}  6{com}.         drop if simple_weights == . 
{txt}  7{com}.         *Compute the NEER 
.         bysort t_p_group : gen pdct = exchange^double_weights
{txt}  8{com}.         bysort t_p_group : gen neer = pdct[1]
{txt}  9{com}.         bysort t_p_group : replace neer = neer[_n-1] * pdct if _n > 1
{txt} 10{com}.         bysort t_p_group : replace neer = neer[_N]
{txt} 11{com}.         cd "`pdir'/data_derived/neer/year"
{txt} 12{com}.         save neer_year_`file', replace
{txt} 13{com}.         project, creates("`pdir'/data_derived/neer/year/neer_year_`file'") 
{txt} 14{com}.         use exchange_year , clear 
{txt} 15{com}.         cd "`pdir'/data_derived/neer"
{txt} 16{com}. {c )-}
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}           1,982
{txt}{col 9}from master{col 30}{res}           1,797{txt}  (_merge_rate==1)
{col 9}from using{col 30}{res}             185{txt}  (_merge_rate==2)

{col 5}matched{col 30}{res}           7,182{txt}  (_merge_rate==3)
{col 5}{hline 41}
(1,982 observations deleted)
(0 observations deleted)
(0 observations deleted)
(6989 real changes made)
(6975 real changes made)
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer/year
{txt}(note: file neer_year_weights.dta not found)
file neer_year_weights.dta saved
project master > do-file creates: {res}"data_derived/neer/year/neer_year_weights.dta" filesig(207504505:510639){txt}
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer

{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}           1,900
{txt}{col 9}from master{col 30}{res}           1,750{txt}  (_merge_rate==1)
{col 9}from using{col 30}{res}             150{txt}  (_merge_rate==2)

{col 5}matched{col 30}{res}           4,907{txt}  (_merge_rate==3)
{col 5}{hline 41}
(1,900 observations deleted)
(0 observations deleted)
(0 observations deleted)
(4804 real changes made)
(4810 real changes made)
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer/year
{txt}(note: file neer_year_weights_agg1.dta not found)
file neer_year_weights_agg1.dta saved
project master > do-file creates: {res}"data_derived/neer/year/neer_year_weights_agg1.dta" filesig(2015839407:351389){txt}
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer

{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}           1,813
{txt}{col 9}from master{col 30}{res}           1,718{txt}  (_merge_rate==1)
{col 9}from using{col 30}{res}              95{txt}  (_merge_rate==2)

{col 5}matched{col 30}{res}           2,159{txt}  (_merge_rate==3)
{col 5}{hline 41}
(1,813 observations deleted)
(0 observations deleted)
(0 observations deleted)
(2131 real changes made)
(2137 real changes made)
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer/year
{txt}(note: file neer_year_weights_agg2.dta not found)
file neer_year_weights_agg2.dta saved
project master > do-file creates: {res}"data_derived/neer/year/neer_year_weights_agg2.dta" filesig(2560317915:159029){txt}
{res}/Users/macbookair/Desktop/OCP_NEER/data_derived/neer
{txt}
{com}. 
. *--------------------------------End of do file------------------------------- 
. 
{txt}end of do-file
      name:  {res}plog_72
       {txt}log:  {res}/Users/macbookair/Desktop/OCP_NEER/Codes/neer_year.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res} 3 Dec 2020, 14:32:49
{txt}{.-}
{smcl}
{txt}{sf}{ul off}